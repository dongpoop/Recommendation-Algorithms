# recommendation_Implementation

这是一个基于协同过滤算法思想的基于物品的协同过滤电影推荐算法实现，包含了两种推荐方式，一种是传统的基于物品的协同过滤实现（这里稍有所不同，不预测评分，而是直接选取与用户历史记录十分相似的电影作为推荐列表，代替了原本的根据评分预测来排序从而确定推荐列表），另一种是将矩阵进行了奇异值分解后，在低维空间中计算物品的相似度。

数据：MovieLens 100k数据集（只使用了u.data文件）。

环境：python（3.10），pycharm，MySql 8.0+

## 如何使用：

1. 下载代码到本地，collaborative_filtering_for_movies.py中含有推荐的所有代码，其余代码均为测试算法性能用到的。

2. 导入数据库，库名movies，表名ml100k，第二个字母是英文l，不是1，第三个才是数字1。

3. 算法的运行分为两步，第一步计算相似度并存储，第二步为用户推荐，所以只需要两个函数就可以了，如果使用普通的推荐，就用compute_similarity_using_for_user函数就行，如果使用奇异值分解的算法，就用compute_similarity_using_for_user_SVD，两者二选一，到此为止第一步完成，第二步只使用一个函数就可以了，recommend函数就可以了。
   
4. 注意：
   
   1）由于作者水平有限，函数封装不够完美，有可能还需要使用者自行更改某些代码，应该主要涉及到代码中连接数据库中使用的用户名和密码问题。虽然函数调用中明确有用户名和密码这两个参数，但是有可能在别的地方并没有使用这两个参数，而是依然使用作者写死的用户名和密码，这需要读者阅读代码并理解代码后修改，相信代码中的注释会对你有所帮助，在此深感抱歉。
   
   2）文件结构如下：
   
   similarity_data：相似度文件夹
   
   collaborative_filtering_for_movies.py：推荐算法主体函数，内部函数间会存在调用关系
   
   test.py: 普通算法的测试函数
   
   test_SVD.py: 使用SVD（奇异值分解）的测试函数
   
   multi_process_experiment.py: 对两个算法进行测试的代码
   
   test_run.py: 开启多进程测试，同时测试两个算法的表现，只需要启动主函数就可以。
   
  3）similarity文件夹是相似数据，当你运行collaborative_filtering_for_movies.py的时候会自动产生。
  
  4）测试指标有两个，一个是precision，另一个是quality，指为用户推荐的电影中用户看了并且评分大于等于4的个数在推荐列表中的占比。
  
  5）其他问题建议看一下代码注释，说不定可以解决你的疑惑，如果不能，欢迎留言讨论交流（友好交流，好好说话😁）。
  
  6）推荐列表需要与电影的全部id取交集，以去除根本不存在的电影，这里没有实现。
  
## 算法基本思想：

### collaborative_filtering_for_movies.py

1.使用从数据库得到的数据在内存中构建临时的数据存储结构（代码中称为评分矩阵，这一步还要对未评分数据进行填充，我是用2.5填充），如下：

                  |      1     2     3     4     5    6   movie_id
         _________|_____________________________________________________________________________________________________
               1  |     3.2   3.1  5.0
         _________|_____________________________________________________________________________________________________
               2  |           2.1               4.0
         _________|_____________________________________________________________________________________________________
               3  |
         _________|_____________________________________________________________________________________________________
          user_id |
                  |
                  
2.计算上图每两列的相似度（有多种方法，我只写了调整的余弦相似度，但是我预留了其他的算法接口，你可以自己定义相似度计算方法），存入**当前目录**下的similarity.data
中（是个csv文件，可以用excel打开，数据太大不建议打开，会崩😱）。使用SVD原理也基本相同，只不过是在更低的维度上计算相似度，相似度计算方法直接使用余弦函数就行。

3.查找相似度文件和用户历史记录，为特定的用户推荐电影。

### 测试基本思想

multi_process_experiment这个模块中是测试设置，进行n(你自己确定)次测试，每次测试取全集的一定比例（同样自己确定这一参数，取出的数据作为训练集，调用collaborative_filtering_for_movies.py中的推荐函数），再到测试集中计算每一个用户的precision和quality后，取所有训练集用户的precision的均值，作为准确率;quality同理。
